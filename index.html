<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChatGPT Advanced - چت‌بات پیشرفته</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="رابط کاربری پیشرفته و فارسی برای ChatGPT با پشتیبانی از جدیدترین مدل‌های OpenAI">
    <meta name="keywords" content="ChatGPT, GPT-4o, هوش مصنوعی, چت بات, فارسی">
    <meta name="author" content="ChatGPT Advanced Team">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="ChatGPT Advanced - چت‌بات پیشرفته">
    <meta property="og:description" content="رابط کاربری پیشرفته و فارسی برای ChatGPT">
    <meta property="og:type" content="website">
    <meta property="og:image" content="./assets/og-image.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="./assets/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./assets/favicon-16x16.png">
    <link rel="apple-touch-icon" href="./assets/apple-touch-icon.png">
    
    <!-- Preconnect for Performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://api.openai.com">
    <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
    
    <!-- External Libraries -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" 
          integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" 
          crossorigin="anonymous" referrerpolicy="no-referrer">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Main Stylesheets -->
    <link rel="stylesheet" href="./styles/main.css">
    <link rel="stylesheet" href="./styles/themes.css">
    <link rel="stylesheet" href="./styles/responsive.css">
    
    <!-- Code Highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css">
    
    <!-- Math Rendering -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <!-- MathJax Configuration -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [[''], ['\\(', '\\)']],
                displayMath: [['$', '$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
            }
        };
    </script>
    
    <!-- Markdown Parser -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body class="loading">
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-logo">
                <i class="fas fa-robot"></i>
            </div>
            <div class="loading-text">
                <h2>ChatGPT Advanced</h2>
                <p>در حال بارگذاری...</p>
            </div>
            <div class="loading-progress">
                <div class="loading-bar">
                    <div class="loading-fill"></div>
                </div>
                <div class="loading-percentage">0%</div>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="app" class="app">
        <!-- Sidebar -->
        <aside id="sidebar" class="sidebar">
            <!-- Sidebar Header -->
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-robot"></i>
                    <h1>ChatGPT</h1>
                    <span class="version">Advanced</span>
                </div>
                <button id="newChatBtn" class="new-chat-btn">
                    <i class="fas fa-plus"></i>
                    <span>گفتگوی جدید</span>
                </button>
            </div>

            <!-- Chat Search -->
            <div id="chatSearchBox" class="chat-search" style="display: none;">
                <div class="search-input-wrapper">
                    <i class="fas fa-search"></i>
                    <input type="text" id="chatSearchInput" placeholder="جستجو در گفتگوها..." autocomplete="off">
                    <button id="clearSearchBtn" class="clear-search-btn">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>

            <!-- Chat List -->
            <div class="chat-list-container">
                <div id="chatList" class="chat-list">
                    <!-- Chat items will be rendered here -->
                </div>
            </div>

            <!-- Sidebar Footer -->
            <div class="sidebar-footer">
                <div class="storage-info">
                    <div class="storage-item">
                        <i class="fas fa-database"></i>
                        <span id="storageUsage">0 KB</span>
                    </div>
                    <div class="storage-item">
                        <i class="fas fa-coins"></i>
                        <span id="tokenUsage">0 توکن</span>
                    </div>
                </div>
                
                <div class="sidebar-actions">
                    <button id="searchChatsBtn" class="sidebar-action-btn" title="جستجو در گفتگوها">
                        <i class="fas fa-search"></i>
                    </button>
                    <button id="exportDataBtn" class="sidebar-action-btn" title="صادرات داده‌ها">
                        <i class="fas fa-download"></i>
                    </button>
                    <button id="settingsBtn" class="sidebar-action-btn" title="تنظیمات">
                        <i class="fas fa-cog"></i>
                    </button>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="chat-header">
                <div class="header-left">
                    <button id="sidebarToggle" class="sidebar-toggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div class="chat-info">
                        <h2 id="chatTitle">گفتگوی جدید</h2>
                        <div class="chat-meta">
                            <span id="messageCount">0 پیام</span>
                            <span class="separator">•</span>
                            <span id="currentModel">GPT-4o</span>
                        </div>
                    </div>
                </div>

                <div class="header-right">
                    <button id="shareBtn" class="header-btn" title="اشتراک‌گذاری">
                        <i class="fas fa-share-alt"></i>
                    </button>
                    <button id="exportBtn" class="header-btn" title="صادرات گفتگو">
                        <i class="fas fa-download"></i>
                    </button>
                    <button id="themeBtn" class="header-btn" title="تغییر تم">
                        <i class="fas fa-moon"></i>
                    </button>
                    <button id="helpBtn" class="header-btn" title="راهنما">
                        <i class="fas fa-question-circle"></i>
                    </button>
                </div>
            </header>

            <!-- Chat Messages Area -->
            <div id="chatMessages" class="chat-messages">
                <!-- Messages will be rendered here -->
            </div>

            <!-- Streaming Indicator -->
            <div id="streamingIndicator" class="streaming-indicator" style="display: none;">
                <div class="streaming-content">
                    <div class="typing-animation">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                    <span class="streaming-text">دستیار در حال تایپ...</span>
                    <button id="cancelStreamBtn" class="cancel-stream-btn">
                        <i class="fas fa-stop"></i>
                        لغو
                    </button>
                </div>
            </div>

            <!-- Input Area -->
            <div class="input-area">
                <div class="text-input-area">
                    <div class="input-actions">
                        <button id="voiceInputBtn" class="input-btn" title="ورودی صوتی">
                            <i class="fas fa-microphone"></i>
                        </button>
                        <button id="fileUploadBtn" class="input-btn" title="آپلود فایل">
                            <i class="fas fa-paperclip"></i>
                        </button>
                    </div>
                    
                    <div class="message-input-wrapper">
                        <textarea 
                            id="messageInput" 
                            class="message-input" 
                            placeholder="پیام خود را اینجا بنویسید..."
                            rows="1"
                            maxlength="8000"
                            autocomplete="off"
                            spellcheck="true"
                        ></textarea>
                        <button id="sendBtn" class="send-btn" disabled>
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>

                <div class="input-footer">
                    <div class="input-hints">
                        <span class="hint-item">
                            <kbd>Enter</kbd> ارسال
                        </span>
                        <span class="hint-item">
                            <kbd>Shift + Enter</kbd> خط جدید
                        </span>
                        <span class="hint-item">
                            <kbd>Ctrl + /</kbd> راهنما
                        </span>
                    </div>
                    
                    <div class="character-counter">
                        <span id="charCount">0</span> / 8000
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal" style="display: none;">
        <div class="modal-overlay" onclick="app.closeAllModals()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-cog"></i> تنظیمات</h2>
                <button class="modal-close" onclick="app.closeAllModals()">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="modal-body">
                <!-- Settings Tabs -->
                <div class="settings-tabs">
                    <button class="tab-btn active" data-tab="api" onclick="app.switchTab('api')">
                        <i class="fas fa-key"></i>
                        API
                    </button>
                    <button class="tab-btn" data-tab="model" onclick="app.switchTab('model')">
                        <i class="fas fa-brain"></i>
                        مدل
                    </button>
                    <button class="tab-btn" data-tab="interface" onclick="app.switchTab('interface')">
                        <i class="fas fa-palette"></i>
                        رابط
                    </button>
                    <button class="tab-btn" data-tab="advanced" onclick="app.switchTab('advanced')">
                        <i class="fas fa-sliders-h"></i>
                        پیشرفته
                    </button>
                </div>

                <!-- API Tab -->
                <div id="apiTab" class="tab-content active">
                    <div class="form-group">
                        <label for="apiKeyInput">
                            <i class="fas fa-key"></i>
                            کلید API
                            <span class="required">*</span>
                        </label>
                        <div class="input-with-btn">
                            <input 
                                type="password" 
                                id="apiKeyInput" 
                                class="form-input" 
                                placeholder="sk-..."
                                autocomplete="off"
                            >
                            <button type="button" id="toggleApiKey" class="toggle-password-btn" onclick="app.togglePasswordVisibility()">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <small class="form-hint">
                            کلید API خود را از 
                            <a href="https://platform.openai.com/api-keys" target="_blank">OpenAI Platform</a>
                            دریافت کنید
                        </small>
                    </div>

                    <div class="form-group">
                        <label for="organizationInput">
                            <i class="fas fa-building"></i>
                            شناسه سازمان (اختیاری)
                        </label>
                        <input 
                            type="text" 
                            id="organizationInput" 
                            class="form-input" 
                            placeholder="org-..."
                        >
                        <small class="form-hint">
                            برای اکانت‌های سازمانی وارد کنید
                        </small>
                    </div>

                    <div class="form-group">
                        <label for="baseUrlInput">
                            <i class="fas fa-globe"></i>
                            URL پایه API
                        </label>
                        <input 
                            type="url" 
                            id="baseUrlInput" 
                            class="form-input" 
                            placeholder="https://api.openai.com/v1"
                            value="https://api.openai.com/v1"
                        >
                        <small class="form-hint">
                            برای پروکسی یا سرور محلی تغییر دهید
                        </small>
                    </div>

                    <div class="api-status" id="apiStatus">
                        <button type="button" id="testApiBtn" class="test-api-btn">
                            <i class="fas fa-flask"></i>
                            تست اتصال API
                        </button>
                        <div id="apiStatusResult" class="api-status-result"></div>
                    </div>
                </div>

                <!-- Model Tab -->
                <div id="modelTab" class="tab-content">
                    <div class="form-group">
                        <label for="modelSelect">
                            <i class="fas fa-brain"></i>
                            مدل
                        </label>
                        <select id="modelSelect" class="form-select">
                            <option value="gpt-4o">GPT-4o (پیشنهادی)</option>
                            <option value="gpt-4o-mini">GPT-4o Mini (سریع و اقتصادی)</option>
                            <option value="o1-preview">o1-preview (تفکر عمیق)</option>
                            <option value="o1-mini">o1-mini (تفکر سریع)</option>
                            <option value="gpt-4-turbo">GPT-4 Turbo</option>
                            <option value="gpt-4">GPT-4</option>
                            <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                        </select>
                        <small class="form-hint" id="modelDescription">
                            جدیدترین و بهترین مدل OpenAI با قابلیت‌های پیشرفته
                        </small>
                    </div>

                    <div class="form-group">
                        <label for="temperatureSlider">
                            <i class="fas fa-thermometer-half"></i>
                            دمای خلاقیت (Temperature): 
                            <span id="temperatureValue">0.7</span>
                        </label>
                        <input 
                            type="range" 
                            id="temperatureSlider" 
                            class="form-range" 
                            min="0" 
                            max="2" 
                            step="0.1" 
                            value="0.7"
                            oninput="document.getElementById('temperatureValue').textContent = this.value"
                        >
                        <div class="range-labels">
                            <span>دقیق (0)</span>
                            <span>متعادل (1)</span>
                            <span>خلاق (2)</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="maxTokensInput">
                            <i class="fas fa-list-ol"></i>
                            حداکثر توکن‌ها
                        </label>
                        <input 
                            type="number" 
                            id="maxTokensInput" 
                            class="form-input" 
                            min="1" 
                            max="4096" 
                            value="2048"
                        >
                        <small class="form-hint">
                            حداکثر طول پاسخ (1-4096)
                        </small>
                    </div>

                    <div class="form-group">
                        <label for="topPSlider">
                            <i class="fas fa-filter"></i>
                            Top-P (تنوع): 
                            <span id="topPValue">1.0</span>
                        </label>
                        <input 
                            type="range" 
                            id="topPSlider" 
                            class="form-range" 
                            min="0.1" 
                            max="1.0" 
                            step="0.1" 
                            value="1.0"
                            oninput="document.getElementById('topPValue').textContent = this.value"
                        >
                    </div>

                    <div class="form-group">
                        <label for="frequencyPenaltySlider">
                            <i class="fas fa-ban"></i>
                            جریمه تکرار: 
                            <span id="frequencyPenaltyValue">0</span>
                        </label>
                        <input 
                            type="range" 
                            id="frequencyPenaltySlider" 
                            class="form-range" 
                            min="-2.0" 
                            max="2.0" 
                            step="0.1" 
                            value="0"
                            oninput="document.getElementById('frequencyPenaltyValue').textContent = this.value"
                        >
                    </div>

                    <div class="form-group">
                        <label for="presencePenaltySlider">
                            <i class="fas fa-eye-slash"></i>
                            جریمه حضور: 
                            <span id="presencePenaltyValue">0</span>
                        </label>
                        <input 
                            type="range" 
                            id="presencePenaltySlider" 
                            class="form-range" 
                            min="-2.0" 
                            max="2.0" 
                            step="0.1" 
                            value="0"
                            oninput="document.getElementById('presencePenaltyValue').textContent = this.value"
                        >
                    </div>

                    <div class="form-group">
                        <label for="systemPromptTextarea">
                            <i class="fas fa-code"></i>
                            پیام سیستم
                        </label>
                        <textarea 
                            id="systemPromptTextarea" 
                            class="form-textarea" 
                            rows="4" 
                            placeholder="شما یک دستیار مفید و باهوش هستید که به زبان فارسی پاسخ می‌دهید..."
                        ></textarea>
                        <small class="form-hint">
                            دستورالعمل اولیه برای مدل (اختیاری)
                        </small>
                    </div>
                </div>

                <!-- Interface Tab -->
                <div id="interfaceTab" class="tab-content">
                    <div class="form-group">
                        <label>
                            <i class="fas fa-palette"></i>
                            تم رنگی
                        </label>
                        <div class="theme-options">
                            <label class="theme-option">
                                <input type="radio" name="theme" value="light">
                                <div class="theme-preview light-theme">
                                    <i class="fas fa-sun"></i>
                                    <span>روشن</span>
                                </div>
                            </label>
                            <label class="theme-option">
                                <input type="radio" name="theme" value="dark">
                                <div class="theme-preview dark-theme">
                                    <i class="fas fa-moon"></i>
                                    <span>تاریک</span>
                                </div>
                            </label>
                            <label class="theme-option">
                                <input type="radio" name="theme" value="auto" checked>
                                <div class="theme-preview auto-theme">
                                    <i class="fas fa-adjust"></i>
                                    <span>خودکار</span>
                                </div>
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>
                            <i class="fas fa-text-height"></i>
                            اندازه فونت
                        </label>
                        <select class="form-select" id="fontSizeSelect">
                            <option value="small">کوچک</option>
                            <option value="medium" selected>متوسط</option>
                            <option value="large">بزرگ</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="showTimestamps" checked>
                                <span class="checkbox-custom"></span>
                                نمایش زمان پیام‌ها
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="showTokenCount" checked>
                                <span class="checkbox-custom"></span>
                                نمایش تعداد توکن‌ها
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="autoScroll" checked>
                                <span class="checkbox-custom"></span>
                                اسکرول خودکار
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="soundEffects">
                                <span class="checkbox-custom"></span>
                                افکت‌های صوتی
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Advanced Tab -->
                <div id="advancedTab" class="tab-content">
                    <div class="form-group">
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="enableStreaming" checked>
                                <span class="checkbox-custom"></span>
                                فعال‌سازی پاسخ جریانی (Streaming)
                            </label>
                        </div>
                        <small class="form-hint">
                            نمایش تدریجی پاسخ‌ها برای تجربه بهتر
                        </small>
                    </div>

                    <div class="form-group">
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="enableContextMemory" checked>
                                <span class="checkbox-custom"></span>
                                حافظه گفتگو (Context Memory)
                            </label>
                        </div>
                        <small class="form-hint">
                            حفظ تاریخچه گفتگو برای پاسخ‌های بهتر
                        </small>
                    </div>

                    <div class="form-group">
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="enableAutoSave" checked>
                                <span class="checkbox-custom"></span>
                                ذخیره خودکار
                            </label>
                        </div>
                        <small class="form-hint">
                            ذخیره خودکار گفتگوها در حافظه محلی
                        </small>
                    </div>

                    <div class="form-group">
                        <label for="contextLengthSelect">
                            <i class="fas fa-memory"></i>
                            طول حافظه گفتگو
                        </label>
                        <select id="contextLengthSelect" class="form-select">
                            <option value="4096">4K توکن</option>
                            <option value="8192">8K توکن</option>
                            <option value="16384" selected>16K توکن</option>
                            <option value="32768">32K توکن</option>
                            <option value="65536">64K توکن</option>
                            <option value="131072">128K توکن</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>
                            <i class="fas fa-database"></i>
                            مدیریت داده‌ها
                        </label>
                        <div class="data-management">
                            <button type="button" class="management-btn" onclick="app.exportAllData()">
                                <i class="fas fa-download"></i>
                                صادرات تمام داده‌ها
                            </button>
                            <button type="button" class="management-btn" onclick="app.importData()">
                                <i class="fas fa-upload"></i>
                                وارد کردن داده‌ها
                            </button>
                            <button type="button" class="management-btn danger" onclick="app.clearAllData()">
                                <i class="fas fa-trash"></i>
                                پاک کردن تمام داده‌ها
                            </button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>
                            <i class="fas fa-info-circle"></i>
                            اطلاعات سیستم
                        </label>
                        <div class="system-info">
                            <div class="info-item">
                                <span>حافظه استفاده شده:</span>
                                <span id="storageInfo">محاسبه...</span>
                            </div>
                            <div class="info-item">
                                <span>تعداد گفتگوها:</span>
                                <span id="chatCountInfo">0</span>
                            </div>
                            <div class="info-item">
                                <span>کل پیام‌ها:</span>
                                <span id="messageCountInfo">0</span>
                            </div>
                            <div class="info-item">
                                <span>نسخه:</span>
                                <span>2.0.0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="app.closeAllModals()">
                    <i class="fas fa-times"></i>
                    انصراف
                </button>
                <button type="button" class="btn btn-primary" onclick="app.saveSettings()">
                    <i class="fas fa-save"></i>
                    ذخیره تنظیمات
                </button>
            </div>
        </div>
    </div>

    <!-- Help Modal -->
    <div id="helpModal" class="modal" style="display: none;">
        <div class="modal-overlay" onclick="app.closeAllModals()"></div>
        <div class="modal-content help-modal">
            <div class="modal-header">
                <h2><i class="fas fa-question-circle"></i> راهنمای استفاده</h2>
                <button class="modal-close" onclick="app.closeAllModals()">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="modal-body">
                <div class="help-section">
                    <h3><i class="fas fa-rocket"></i> شروع سریع</h3>
                    <ol>
                        <li>کلید API خود را از <a href="https://platform.openai.com/api-keys" target="_blank">OpenAI</a> دریافت کنید</li>
                        <li>در تنظیمات، کلید API را وارد کنید</li>
                        <li>مدل مورد نظر را انتخاب کنید</li>
                        <li>شروع به گفتگو کنید!</li>
                    </ol>
                </div>

                <div class="help-section">
                    <h3><i class="fas fa-brain"></i> مدل‌های پیشنهادی</h3>
                    <ul>
                        <li><strong>GPT-4o:</strong> بهترین کیفیت برای همه موارد</li>
                        <li><strong>GPT-4o Mini:</strong> سریع و اقتصادی</li>
                        <li><strong>o1-preview:</strong> برای مسائل پیچیده و ریاضی</li>
                        <li><strong>GPT-4 Turbo:</strong> حافظه بالا و دقت خوب</li>
                    </ul>
                </div>

                <div class="help-section">
                    <h3><i class="fas fa-keyboard"></i> میانبرهای مفید</h3>
                    <div class="keyboard-shortcuts">
                        <div class="shortcut">
                            <kbd>Ctrl</kbd> + <kbd>Enter</kbd>
                            <span>ارسال پیام</span>
                        </div>
                        <div class="shortcut">
                            <kbd>Ctrl</kbd> + <kbd>N</kbd>
                            <span>گفتگوی جدید</span>
                        </div>
                        <div class="shortcut">
                            <kbd>Ctrl</kbd> + <kbd>S</kbd>
                            <span>صادرات گفتگو</span>
                        </div>
                        <div class="shortcut">
                            <kbd>Ctrl</kbd> + <kbd>,</kbd>
                            <span>باز کردن تنظیمات</span>
                        </div>
                        <div class="shortcut">
                            <kbd>Shift</kbd> + <kbd>Enter</kbd>
                            <span>خط جدید</span>
                        </div>
                        <div class="shortcut">
                            <kbd>Esc</kbd>
                            <span>لغو عملیات</span>
                        </div>
                    </div>
                </div>

                <div class="help-section">
                    <h3><i class="fas fa-tips"></i> نکات مفید</h3>
                    <ul>
                        <li>برای بهترین نتایج، سوال‌های واضح و دقیق بپرسید</li>
                        <li>از پیام سیستم برای تنظیم رفتار دستیار استفاده کنید</li>
                        <li>برای کدنویسی، دمای پایین‌تر (0.3) بهتر است</li>
                        <li>برای خلاقیت، دمای بالاتر (0.8-1.0) مناسب‌تر است</li>
                        <li>گفتگوهای خود را منظماً صادر و پشتیبان‌گیری کنید</li>
                    </ul>
                </div>

                <div class="help-section">
                    <h3><i class="fas fa-shield-alt"></i> حریم خصوصی</h3>
                    <ul>
                        <li>کلید API شما فقط در مرورگر شما ذخیره می‌شود</li>
                        <li>هیچ داده‌ای به سرورهای ما ارسال نمی‌شود</li>
                        <li>تمام گفتگوها محلی ذخیره می‌شوند</li>
                        <li>شما کنترل کامل بر داده‌های خود دارید</li>
                    </ul>
                </div>

                <div class="help-section">
                    <h3><i class="fas fa-life-ring"></i> پشتیبانی</h3>
                    <p>
                        برای دریافت کمک بیشتر، می‌توانید:
                    </p>
                    <ul>
                        <li><a href="#" target="_blank">مستندات کامل</a> را مطالعه کنید</li>
                        <li>در <a href="#" target="_blank">GitHub Issues</a> سوال بپرسید</li>
                        <li>از طریق <a href="mailto:support@example.com">ایمیل</a> تماس بگیرید</li>
                    </ul>
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-primary" onclick="app.closeAllModals()">
                    <i class="fas fa-check"></i>
                    متوجه شدم
                </button>
            </div>
        </div>
    </div>

    <!-- File Upload Input (Hidden) -->
    <input type="file" id="fileInput" accept=".txt,.md,.json,.csv" multiple style="display: none;">

    <!-- Audio Input (Hidden) -->
    <input type="file" id="audioInput" accept="audio/*" style="display: none;">

    <!-- Sidebar Overlay (Mobile) -->
    <div id="sidebarOverlay" class="sidebar-overlay"></div>

    <!-- External Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>

    <!-- Application Scripts -->
  <script src="./scripts/utils.js"></script>
<script src="./scripts/api.js"></script>
<script src="./scripts/main.js"></script>

    <!-- Service Worker Registration -->
    <script>
        // Progressive Web App Support
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(registration => {
                        console.log('SW registered: ', registration);
                    })
                    .catch(registrationError => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }

        // Loading Screen Management
        window.addEventListener('load', () => {
            setTimeout(() => {
                const loadingScreen = document.getElementById('loadingScreen');
                const app = document.getElementById('app');
                
                loadingScreen.style.opacity = '0';
                setTimeout(() => {
                    loadingScreen.style.display = 'none';
                    app.style.display = 'flex';
                    document.body.classList.remove('loading');
                }, 300);
            }, 1000);
        });

        // Loading Progress Simulation
        window.addEventListener('DOMContentLoaded', () => {
            const loadingFill = document.querySelector('.loading-fill');
            const loadingPercentage = document.querySelector('.loading-percentage');
            let progress = 0;
            
            const interval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress > 100) progress = 100;
                
                loadingFill.style.width = progress + '%';
                loadingPercentage.textContent = Math.floor(progress) + '%';
                
                if (progress >= 100) {
                    clearInterval(interval);
                }
            }, 100);
        });

        // Global Error Handler
        window.addEventListener('error', (event) => {
            console.error('Global error:', event.error);
            if (window.app && window.app.showNotification) {
                window.app.showNotification('خطای غیرمنتظره رخ داده است', 'error');
            }
        });

        // Keyboard Shortcuts
        document.addEventListener('keydown', (e) => {
            // Ctrl+N - New Chat
            if (e.ctrlKey && e.key === 'n') {
                e.preventDefault();
                if (window.app) window.app.createNewChat();
            }
            
            // Ctrl+S - Export Chat
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                if (window.app) window.app.exportCurrentChat();
            }
            
            // Ctrl+, - Open Settings
            if (e.ctrlKey && e.key === ',') {
                e.preventDefault();
                if (window.app) window.app.openSettingsModal();
            }
            
            // Ctrl+/ - Open Help
            if (e.ctrlKey && e.key === '/') {
                e.preventDefault();
                if (window.app) window.app.openHelpModal();
            }
            
            // Escape - Close Modals
            if (e.key === 'Escape') {
                if (window.app) window.app.closeAllModals();
            }
        });

        // Prevent right-click context menu on production
        if (location.protocol !== 'file:' && !location.hostname.includes('localhost')) {
            document.addEventListener('contextmenu', e => e.preventDefault());
        }

        // Performance monitoring
        if ('performance' in window && 'PerformanceObserver' in window) {
            const observer = new PerformanceObserver((list) => {
                for (const entry of list.getEntries()) {
                    if (entry.entryType === 'navigation') {
                        console.log(`Page load time: ${entry.loadEventEnd - entry.loadEventStart}ms`);
                    }
                }
            });
            observer.observe({entryTypes: ['navigation']});
        }
    </script>

    <!-- Meta for iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ChatGPT Advanced">
    
    <!-- Meta for Android -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="ChatGPT Advanced">
    
    <!-- Theme Color -->
    <meta name="theme-color" content="#4f46e5">
    <meta name="msapplication-TileColor" content="#4f46e5">
</body>
</html>
